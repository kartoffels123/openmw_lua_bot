{
  "folder_name": "Farming (openMw)",
  "lua_files": {
    "Farming-55217-0-5-1726085172\\Farming\\Data_Files\\Scripts\\Farming\\Activators.lua": " local self=require('openmw.self')\nlocal core=require('openmw.core')\nlocal types = require('openmw.types')\n\n\nlocal function Activate(data)\n\tif string.find(self.type.record(self).name,\"Young\") then\n\t\tcore.sendGlobalEvent(\"CarePlant\",{Plant=self, Player=data})\n\tend\n\n\tif self.recordId==\"clod\" and string.find(types.Weapon.record(types.Actor.getEquipment(data,types.Actor.EQUIPMENT_SLOT.CarriedRight)).name,\"seed\") then\n\t\tcore.sound.playSound3d(\"animalLARGEleft\",self)\n\t\tcore.sendGlobalEvent('CreateYoungFlora',{ Name = string.gsub(types.Weapon.record(types.Actor.getEquipment(data,types.Actor.EQUIPMENT_SLOT.CarriedRight)).name,\" seed\",\"\"), CellName=self.cell.name, Position=self.position})\n\t\tcore.sendGlobalEvent('RemoveItem',{ Object = self, number=1})\n\t\tcore.sendGlobalEvent('RemoveItem',{ Object = types.Actor.getEquipment(data,types.Actor.EQUIPMENT_SLOT.CarriedRight), number=1})\n\tend\nend\n\nreturn {\n\teventHandlers = {},\n\tengineHandlers = {\n\t\tonActivated=Activate\n\t}\n\n}",
    "Farming-55217-0-5-1726085172\\Farming\\Data_Files\\Scripts\\Farming\\Global.lua": "local world = require('openmw.world')\nlocal types = require('openmw.types')\nlocal util = require('openmw.util')\n\nlocal Initialize=false\nlocal Seeds={}\nlocal YoungFlora={}\nlocal SavedData={}\nlocal VFXmodel='meshes/farming/mudbursts.nif'\n\nif SavedData.SeedsRecordId==nil then\n\tSavedData.SeedsRecordId={}\nend\nif SavedData.FloraIngredients==nil then\n\tSavedData.FloraIngredients={}\nend\nif SavedData.YoungFlora==nil then\n\tSavedData.YoungFlora={}\n\tSavedData.YoungFlora.List={}\n\tSavedData.YoungFlora.Cared={}\nend\nif SavedData.YoungFlora then\n\tif SavedData.YoungFlora.List==nil then\n\t\tSavedData.YoungFlora.List={}\n\tend\n\tif SavedData.YoungFlora.Cared==nil then\n\t\tSavedData.YoungFlora.Cared={}\n\tend\nend\n\n\nlocal ActiveCell=nil\n\nlocal function SetScale(data)\n\tdata.Object:setScale(data.scale)\nend\n\nlocal function RemoveItem(data)\n\tif data.number>0 and data.Object.count>0 then\n\t\tdata.Object:remove(data.number)\n\tend\nend\n\nlocal function CreateClod(data)\n\tworld.createObject(data.RecordId,1):teleport(data.CellName,data.Position)\n\t\tworld.vfx.spawn(VFXmodel,data.Position)\nend\n\nlocal function CreateYoungFlora(data)\n\tlocal YoungF=nil\n\tfor i,youngflora in pairs(YoungFlora) do\n\t\tif youngflora.name==\"Young \"..data.Name then\n\t\t\tYoungF=world.createObject(youngflora.id,1)\n\t\t\ttable.insert(SavedData.YoungFlora.List,YoungF)\n\t\t\tSavedData.YoungFlora.Cared[YoungF.id]=0\n\t\t\tYoungF:setScale(0.1)\n\t\t\tworld.vfx.spawn(VFXmodel,data.Position)\n\t\t\tYoungF:teleport(data.CellName,data.Position+util.vector3(0,0,0))\n\t\t\tbreak\n\t\tend\n\tend\nend\n\nlocal function CarePlant(data)\n\t\n\tif SavedData.YoungFlora.Cared[data.Plant.id]==0 then\n\t\tif types.Actor.stats.dynamic.fatigue(data.Player).current>50 then\n\t\t\tdata.Player:sendEvent(\"TakeCare\",{Cared=false})\n\t\t\tSavedData.YoungFlora.Cared[data.Plant.id]=types.NPC.stats.skills.restoration(data.Player).modified/2\n\t\telse\n\t\t\tdata.Player:sendEvent(\"TakeCare\",{Cared=false})\n\t\tend\n\telse \n\t\tdata.Player:sendEvent(\"TakeCare\",{Cared=true})\n\tend\nend\n\nlocal function GrowPlants(data)\n\t--if data.player==world.players[1] then\n\t\tif SavedData.YoungFlora~=nil then\n\t\t\tfor i, youngplant in pairs(SavedData.YoungFlora.List) do\n\t\t\t\tif youngplant:isValid() then\n\t\t\t\t\tif youngplant.scale<1 then\n\t\t\t\t\t\tlocal GrowChance=5\n\t\t\t\t\t\tGrowChance=GrowChance+SavedData.YoungFlora.Cared[youngplant.id]\n\t\t\t\t\t\tSavedData.YoungFlora.Cared[youngplant.id]=0\n\t\t\t\t\t\tfor i, container in pairs(youngplant.cell:getAll(types.Container)) do\n\t\t\t\t\t\t\tif container.type.record(container).name==string.gsub(youngplant.type.record(youngplant).name,\"Young \",\"\") then\n\t\t\t\t\t\t\t\tif (container.position.z>0 and youngplant.position.z>0) or (container.position.z<0 and youngplant.position.z<0) then\n\t\t\t\t\t\t\t\t\tGrowChance=GrowChance+5\n\t\t\t\t\t\t\t\tend\n\t\t\t\t\t\t\tend\n\t\t\t\t\t\tend\n\t\t\t\t\t\tif math.random(100)<GrowChance then\n\t\t\t\t\t\t\tyoungplant:setScale(youngplant.scale+0.1)\n\t\t\t\t\t\tend\n\t\t\t\t\telseif youngplant.scale>1 and youngplant.scale<1.1 and youngplant.count>0 then\n\t\t\t\t\t\tlocal Flora\n\t\t\t\t\t\tfor i,container in pairs(types.Container.records) do\n\t\t\t\t\t\t\tif container.name==string.gsub(youngplant.type.record(youngplant).name,\"Young \",\"\") and container.model==youngplant.type.record(youngplant).model then\n\t\t\t\t\t\t\t\tFlora=world.createObject(container.id,1)\n\t\t\t\t\t\t\t\tif SavedData.FloraIngredients[container.name] then\n\t\t\t\t\t\t\t\t\tworld.createObject(SavedData.FloraIngredients[container.name],1):moveInto(types.Container.content(Flora))\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\ttypes.Container.content(Flora):resolve()\n\t\t\t\t\t\t\t\tend\n\t\t\t\t\t\t\t\tSavedData.YoungFlora.Cared[youngplant.id]=nil\n\t\t\t\t\t\t\t\tSavedData.YoungFlora.List[youngplant]=nil\n\t\t\t\t\t\t\t\tFlora:teleport(youngplant.cell.name,youngplant.position)\n\t\t\t\t\t\t\t\tyoungplant:remove()\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\tend\n\t\t\t\t\t\tend\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\t--end\n\t\nend\n\nlocal function CreateFlora(data)\n\tlocal Flora\n\tfor i,container in pairs(types.Container.records) do\n\t\tif container.name==string.gsub(data.Object.type.record(data.Object).name,\"Young \",\"\") and container.model==data.Object.type.record(data.Object).model then\n\t\t\tFlora=world.createObject(container.id,1)\n\t\t\tif SavedData.FloraIngredients[container.name] then\n\t\t\t\tworld.createObject(SavedData.FloraIngredients[container.name],1):moveInto(types.Container.content(Flora))\n\t\t\telse\n\t\t\t\ttypes.Container.content(Flora):resolve()\n\t\t\tend\n\t\t\tFlora:teleport(data.CellName,data.Position+util.vector3(0,0,10))\n\t\t\tbreak\n\t\tend\n\tend\nend\n\n\nlocal function CreateMoveInto(data)\n\tworld.createObject(data.Object,1):moveInto(types.Container.content(data.container))\nend\n\nlocal function onUpdate()\n\tif Initialize==false then\n\t\tInitialize=true\n\t\tfor i,container in pairs(types.Container.records) do\n\t\t\tif container.weight==0 and string.find(container.id,\"flora\") then --Check string waiting for checking respan and organic in container.record\n\t\t\t\tSeeds[container.name]=world.createRecord(types.Weapon.createRecordDraft({\tname=container.name..\" seed\", \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=10, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tweight=0.01,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"icons/farming/seed.tga\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodel=\"meshes\\\\farming\\\\seed.nif\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=types.Weapon.TYPE.MarksmanThrown,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tspeed=1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treach=1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thealth=1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))\n\t\t\t\tYoungFlora[container.name]=world.createRecord(types.Activator.createRecordDraft({\tname=\"Young \"..container.name, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodel=container.model,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))\n\t\t\tend\n\t\tend\n\tend\n\n\tif ActiveCell==nil then\n\t\tActiveCell=world.players[1].cell\n\telseif ActiveCell~=world.players[1].cell then\t\n\t\tActiveCell=world.players[1].cell\n\t\tfor i, object in ipairs(world.players[1].cell:getAll(types.Container)) do\n\t\t\tif object.type.record(object).weight==0 and string.find(object.type.record(object).id,\"flora\") then --Check string waiting for checking respawn and organic in container.record\n\t\t\t\tif math.random(100)<=10 then\n\t\t\t\t\tworld.createObject(Seeds[object.type.record(object).name].id,1 ):moveInto(types.Container.content(object))\n\t\t\t\t\tprint(object)\n\t\t\t\tend\n\t\t\t\tif SavedData.FloraIngredients[object.type.record(object).name]==nil and object.type.content(object):getAll(types.Ingredient)[1] then\n\t\t\t\t\tSavedData.FloraIngredients[object.type.record(object).name]=object.type.content(object):getAll(types.Ingredient)[1].recordId\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\nend\n\n\nlocal function onSave()\n\treturn{SavedData=SavedData,}\nend\n\nlocal function onLoad(data)\n\tif data then\n\t\tSavedData=data.SavedData\n\tend\nend\n\n\nreturn {\n\teventHandlers = {CarePlant=CarePlant, GrowPlants=GrowPlants, CreateFlora=CreateFlora,SetScale=SetScale, CreateYoungFlora=CreateYoungFlora, CreateClod=CreateClod,RemoveItem=RemoveItem,},\n\tengineHandlers = {\n        onUpdate = onUpdate,\n\t\tonSave=onSave,\n\t\tonLoad=onLoad,\n\n\t},\n}",
    "Farming-55217-0-5-1726085172\\Farming\\Data_Files\\Scripts\\Farming\\Player.lua": "local self=require('openmw.self')\nlocal ui=require('openmw.ui')\nlocal core=require('openmw.core')\nlocal types = require('openmw.types')\nlocal util = require('openmw.util')\nlocal nearby = require('openmw.nearby')\nlocal I = require('openmw.interfaces')\n\nlocal ActionButton=false\nlocal TimeChecking=core.getGameTime()\n\n\nlocal function TakeCare(data)\n\tif data.Cared==false then\n\t\tif types.Actor.stats.dynamic.fatigue(self).current>50 then\n\t\t\ttypes.Actor.stats.dynamic.fatigue(self).current=types.Actor.stats.dynamic.fatigue(self).current-50\n\t\t\tui.showMessage(\"You take care of the plant\")\n\t\t\tcore.sound.playSound3d(\"animalLARGEleft\",self)\n\t\t\ttypes.NPC.stats.skills.restoration(self).progress=types.NPC.stats.skills.restoration(self).progress+0.01\n\t\t\tif types.NPC.stats.skills.restoration(self).progress>1 then\n\t\t\t\tI.SkillProgression.skillLevelUp(\"restoration\",I.SkillProgression.SKILL_INCREASE_SOURCES.Usage)\n\t\t\tend\n\t\telse\n\t\t\tui.showMessage(\"You are too exhausted to take care of the plant\")\n\t\tend\n\telse\n\t\tui.showMessage(\"You already have taken care of this plant today\")\n\tend\nend\n\nlocal function onFrame()\n\tif core.getGameTime()>(TimeChecking+86400) then\n\t\tcore.sendGlobalEvent(\"GrowPlants\",{player=self})\n\t\tTimeChecking=TimeChecking+86400\n\telseif core.getGameTime()<TimeChecking then\n\t\tTimeChecking=core.getGameTime()\n\tend\nend\n\nlocal function CheckPlantInCell()\n\tfor i, container in pairs(nearby.containers) do\n\t\tif container.type.record(container).weight==0 and string.find(container.type.record(container).id,\"flora\") then\n\t\t\treturn(true)\n\t\tend\n\tend\nend\n\nlocal function onUpdate()\n\tif self.controls.use==0 \n\tand ActionButton==true \n\tand types.Actor.getStance(self) == 1 \n\tand types.Actor.getEquipment(self, 16) \n\tand CheckPlantInCell()==true\n\tthen\n\t\tActionButton=false \n\t\tif types.Actor.getEquipment(self, 16).recordId==\"miner's pick\"  then\n\t\t\t\tActionButton=false\n\t\t\t\tlocal RotZ = self.rotation:getPitch()\n\t\t\t\tlocal RotX = self.rotation:getYaw()\n\t\t\t\tlocal Ray = nearby.castRay(\n\t\t\t\t\tutil.vector3(0, 0, 110) + self.position +\n\t\t\t\t\tutil.vector3(math.cos(RotZ) * math.sin(RotX), math.cos(RotZ) * math.cos(RotX), -math.sin(RotZ)) * 50,\n\t\t\t\t\tutil.vector3(0, 0, 110) + self.position +\n\t\t\t\t\tutil.vector3(math.cos(RotZ) * math.sin(RotX), math.cos(RotZ) * math.cos(RotX), -math.sin(RotZ)) * 150)\n\n\t\t\t\tif Ray.hit and Ray.hitObject==nil then\n\t\t\t\t\tif types.Actor.stats.dynamic.fatigue(self).current>100 then\n\t\t\t\t\t\ttypes.Actor.stats.dynamic.fatigue(self).current=types.Actor.stats.dynamic.fatigue(self).current-100\n\t\t\t\t\tfor i, activator in pairs(nearby.activators) do\n\t\t\t\t\t\tif activator.recordId==\"clod\" then\n\t\t\t\t\t\t\tif (activator.position-Ray.hitPos):length()<100 then\n\t\t\t\t\t\t\t\tcore.sendGlobalEvent('RemoveItem',{ Object = activator, number=1})\n\t\t\t\t\t\t\tend\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tend\n\t\t\t\t\t\t\n\t\t\t\t\t\tif types.Activator.record(activator).name then\n\t\t\t\t\t\t\tif string.find(types.Activator.record(activator).name,\"Young \") and (activator.position-self.position):length()<100 then\n\t\t\t\t\t\t\t\tcore.sendGlobalEvent('RemoveItem',{ Object = activator, number=1})\n\t\t\t\t\t\t\tend\n\t\t\t\t\t\tend\n\t\t\t\t\tend\n\t\t\t\t\tcore.sendGlobalEvent('CreateClod',{ RecordId = \"Clod\", CellName=self.cell.name, Position=Ray.hitPos})\n\t\t\t\t\tcore.sound.playSound3d(\"animalLARGEleft\",self)\n\t\t\t\telse\n\t\t\t\t\tui.showMessage(\"You are too exhausted to turn the soil\")\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\telseif self.controls.use==1 and ActionButton==false then \n\t\tActionButton=true\n\tend\n\nend\n\nreturn {\n\teventHandlers = {TakeCare=TakeCare},\n\tengineHandlers = {\n\n        onFrame = onFrame,\n\t\tonUpdate=onUpdate,\n\t}\n\n}"
  }
}